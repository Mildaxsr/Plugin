# Отчёт
## Разработка плагина для IDE  
### Плагин обработки комментариев для Visual Studio Code

---

## 1. Архитектура VS Code и механизм подключения сторонних расширений

Visual Studio Code — модульная IDE, поддерживающая подключение сторонних расширений.  
Каждое расширение работает в отдельном процессе **Extension Host**, что обеспечивает стабильность и изоляцию.

### 1.1. Extension Host

Extension Host — отдельный процесс, в котором выполняются плагины.  
Преимущества архитектуры:
- изоляция ошибок плагинов,
- устойчивость IDE,
- независимость расширений друг от друга.

---

### 1.2. package.json — конфигурационный центр расширения

Файл `package.json` содержит описание расширения, включая:
- название, версию, автора;
- главный файл (`main`);
- список команд;
- горячие клавиши;
- события активации;
- категории и права.

VS Code использует этот файл для того, чтобы понять:
- когда активировать расширение,
- какие команды оно предоставляет,
- как оно интегрируется с интерфейсом.

---

### 1.3. События активации (Activation Events)

Расширение активируется только при необходимости.

Используемые события:
- `onCommand:commentFormatter.addComments`
- `onCommand:commentFormatter.removeComments`
- `onCommand:commentFormatter.formatComments`

То есть плагин загружается в момент вызова команды или горячей клавиши.

---

### 1.4. Commands API

Регистрация команд производится через:

```
vscode.commands.registerTextEditorCommand()
```

После регистрации команды доступны:
- через Command Palette (Ctrl + Shift + P),
- через горячие клавиши,
- в меню.

---

### 1.5. Работа с текстом

VS Code предоставляет API для работы с документами:

- **TextEditor** — текущее текстовое окно,
- **TextEditorEdit** — объект изменения текста,
- API позволяет получить выделенный текст, модифицировать его и записать обратно.

---

## 2. Архитектура разработанного плагина

Плагин разделён на несколько модулей, каждый выполняет строго определённую функцию.

---

### 2.1. package.json

Содержит:
- список команд,
- горячие клавиши,
- события активации,
- связь с `extension.js`.

---

### 2.2. extension.js — основной модуль

Именно здесь размещена:
- регистрация команд,
- обработка выделенного текста,
- вызов функций логики (добавление, удаление, форматирование комментариев).

---

### 2.3. Функции обработки текста

| Функция | Описание |
|--------|----------|
| `addComments()` | Добавляет `#` перед каждой строкой |
| `removeComments()` | Убирает `#` и пробел после него |
| `formatComments()` | Форматирует строки комментариев под 80 символов |
| `wrapText()` | Низкоуровневый перенос строки по словам |
| `processText()` | Преобразует выделенный текст → список строк → обратно |
| `applyToSelections()` | Применяет функцию к каждой выделенной области |

---

### 2.4. Диаграмма архитектуры

```
                  ┌───────────────────────────────┐
                  │           VS Code              │
                  │       (Extension Host)         │
                  └───────────────┬───────────────┘
                                  │
                       читает package.json
                                  │
                  ┌───────────────▼───────────────┐
                  │     Comment Formatter          │
                  ├────────────────────────────────┤
                  │  Команды:                      │
                  │   - addComments                │
                  │   - removeComments             │
                  │   - formatComments             │
                  ├────────────────────────────────┤
                  │ activate()                     │
                  │  │ регистрация команд          │
                  │  └ обработка выделения         │
                  ├────────────────────────────────┤
                  │ Логика                         │
                  │ - addComments()                │
                  │ - removeComments()             │
                  │ - formatComments()             │
                  └────────────────────────────────┘
```

---

## 3. Структура проекта

```
plugin/
│
├── extension.js        # Основная логика плагина
├── package.json        # Конфигурация
├── README.md           # Описание расширения
├── docs/               # Автоматически сгенерированная документация (JSDoc)
└── report.md           # Отчёт (этот файл)
```

---

## 4. Документация

Документация генерируется инструментом **JSDoc**.

Команда генерации:

```
jsdoc extension.js -d docs
```

В результате создаётся папка `docs/` со структурированной документацией всех функций расширения.

---

## 5. GitHub

Проект опубликован в общедоступном репозитории GitHub и содержит:
- исходный код плагина,
- README.md с описанием,
- автоматически сгенерированную документацию,
- отчёт.
